# TODO

## 🏗️ アーキテクチャ・リファクタリング

- [ ] 肥大化した `Controller` への対処（責務の分散）
- [x] `Controller.is_valid_excel_file()` を `spreadsheet_reader` に移動する
- [x] `MainWindow.closeEvent()` を整理: `view.py` で `WindowGeometry` のimportを不要にする
- [x] `MainToolBar.action_open` を private メソッドに変更

## 🏗️ アーキテクチャ・リファクタリング / モデル改善

- [ ] `DetailNode` にツリー表示用文字列を返すプロパティ `tree_label` を実装
  - 返り値の例: "PL 160 x 9 x 640 (SM400A)"

## ✨ MaterialTreeView (GUI)

- [x] 員数列を右揃えに変更
- [x] ツリー展開ボタンを追加 (右クリックメニュー)
- [x] 設定の永続化 (iniファイル保存): セパレータ幅
- [ ] 縦スクロールバーを常に表示

## ✨ GUI

- [ ] メニューバーの実装
- [ ] 環境設定の実装
- [ ] バージョン情報の表示

## 🛡️ Excel読込・バリデーション

- [ ] 追加時のみ Excel ファイルを開く処理に変更
  - `with` 構文内で `load_workbook()` を実行
- [ ] 追加済みの Excel ファイルを再読み込みするボタンを追加
  - 再読み込み時にファイルパスが存在しない場合、リストから除外
- [ ] 追加済みの Excel ファイルを上書き保存 (タイムスタンプを更新) した場合、画面に通知する機能
- [ ] ファイル読み込み時: 有効な材片テーブルが存在するかチェック
- [ ] ファイル内容のバリデーション (材片名、員数の妥当性など)
- [ ] Excel 読込時に不正なシートを除外する処理
  - 非表示のシート
  - 不正なヘッダー
  - 不正な階層構造: #1 階層が存在しない
  - 不正な階層構造: #2 の次が #4 のように階層が連続していない
- [ ] 不正な Excel ファイル読込時のエラー処理
  - 読み込み可能なシートが存在しない場合
- [ ] ファイル保存時にファイル名選択ダイアログを表示 (`Controller.save_file`)
  - デフォルト名は先頭の Excel ファイル名を基にする
  - 日時のサフィックスを付与するオプション

## 🏗️ ビルド

- [ ] pyinstaller でビルド済みのバイナリファイルを追加
- [ ] インストーラの検討 (Inno Setup)

## 📖 ドキュメント

- [ ] README: 内容の見直し
- [ ] README: まてりある入力用Excelテンプレートデータの設置
